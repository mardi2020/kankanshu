# 성능에 핵심인 DB
- 책 속의 사례: 10초가 넘도록 응답을 받지 못해 에러 발생
  - 문제 분석: 사용자가 조금만 증가해도 DB 장비의 CPU 사용률이 90%를 넘기면서 전체 쿼리 실행 시간이 느려지고 서버의 응답시간도 느려짐
  - 원인: 풀스캔
    - 호출 빈도가 높은 기능에 풀 스캔을 유발하는 쿼리가 있었음
    - 데이터 개수가 증가하면서 풀스캔으로 인해 쿼리 실행 시간이 느려짐
    - 풀스캔: 테이블의 **모든** 데이터(row)를 순차적으로 읽는 것
      - 보통 쿼리의 WHERE 절에 있는 조건에 대응하는 인덱스가 없을 때 테이블 전체를 풀 스캔하여 원하는 데이터를 찾아냄
      - 인덱스를 사용하지 못하는 경우
        - `LIKE '%keyword%'`, OR/NOT 등 특정 조건, 인덱스 열에 함수나 연산을 적용하는 경우(WHERE UPPER(name) = 'TOM')
        -  DB optimizer가 인덱스 사용보다 풀 스캔이 빠르다고 판단할 때(ex: 테이블의 대부분의 데이터를 반환해야할 때)
    - 풀스캔을 방지할 수 있는 방법
      - 적절한 인덱스 생성: 자주 검색하는 열에 인덱스 설정
      - 쿼리 튜닝: 불필요한 `SELECT *` 대신 필요한 컬럼만 지정하여 조회
      - 쿼리 힌트 사용: optimizer가 인덱스를 강제로 사용하도록 `USE INDEX` hint를 사용
    - 풀 스캔이 발생하는지 확인하는 방법
      ```sql
        EXPLAIN
          SELECT *
          FROM customers
          WHERE name = 'Tom'; --output이 ALL로 표시되면 풀 스캔 발생
      ``` 

## 정리
- 알아두어야 할 상식: DB 성능에 문제가 생기면 전체 서비스에 영향을 줌
