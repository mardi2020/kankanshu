# 몇 가지 성능 개선 방법
- **조회 범위를 시간 기준으로 제한하기**
  - Ex) 뉴스 기사 목록 - 기사 목록 제공시 **일자별로 분류해 제공**
    ```sql
    select title, ...
    from news
    where regdt >= '2024-08-09 00:00:00' and regdt < '2024-08-10 00:00:00'
    order by regdt desc
    limit 100;
    ```
    - regdt에 인덱스를 추가해서 성능 저하를 개선하면 됨
      - where 절에 and category = '01' 과 같은 다른 조건이 더해져도 성능이 유지됨
  - Ex) 쇼핑사이트에서 회원의 주문 내역을 조회하는 기능
    - **월별로 주문 내역을 조회**하는 쿼리, 필요한 인덱스는 (customerId, orderDt)
    ``` sql
    select id, ...
    from order
    where customerId = 100
      and orderDt >= '2024-08-01 00:00:00' and orderDt < '2024-09-01 00:00:00'
    order by orderDt desc;
    ```
    - 페이지 기준 목록 조회나 ID 기준 목록 조회에 비해 쿼리가 단순해지고 성능 문제도 발생하지 않음
  - 아니면, **최신 데이터만 조회하자**
    - Ex) 고객에게 매달 한번씩 제공하는 점검결과가 있다고 가정
      - 대부분의 고객은 결과가 정상인지에 대해 관심이 있지 이전에 받은 결과에는 관심이 크게 없을 것임
      - 이럴 경우, 최근 6개월간의 점검 결과만 제공해도 서비스에는 문제가 되지 않음
    - Ex) 공지사항
      - 며칠 또는 몇 달 이내의 공지는 읽을 수 있지만, 3년전의 내용은 아무도 안읽음
    - 최신 데이터 위주로 조회하게 기능을 변경하면 db 성능도 향상됨
      - db는 성능을 높이기 위해 메모리 캐시를 사용하고 있음
        - 데이터 조회가 발생하면 이를 캐싱해 다음 요청에 대해선 빠르게 응답함
        - 캐시 효율을 높여 응답 속도를 개선시킬 수 있는 방법임

  - **전체 개수 세지 않기**
    - Ex) 이름에 특정 단어가 포함된 회원 목록을 조회하려면 다음 두 쿼리를 실행해야 함
      ``` sql
      select id, ...
      from member
      where name like '지은%'
      order by id desc
      limit 20;

      select count(*)
      from member
      where name like '지은%';
      ```
      - 데이터가 많아질 경우, count 쿼리의 실행시간이 증가함 -> 조건에 해당하는 모든 데이터를 탐색하기 때문
      - 커버링 인덱스를 사용하더라도 전체 인덱스를 스캔해야 하며, 커버링 인덱스가 아닌 경우에는 실제 데이터를 전부 읽어야 함

- **오래된 데이터 삭제 및 분리 보관하기**
  - 데이터 개수가 늘어날수록 쿼리 실행 시간은 증가함
  - 데이터 개수가 증가하지 않거나 데이터 증가 속도를 낮추면, 실행 시간 증가 폭을 줄일 수 있음
  - 과거 데이터를 삭제하면 데이터 개수를 일정하게 유지 가능하므로 성능 또한 일정 수준으로 유지됨
    - Ex) 로그인 시도 내역

  - **별도 캐시 서버 구성하기**
    - db를 확장하는 것보다 캐시서버를 구성하는 것이 부담이 적고, 캐시로 증가시킬 수 있는 처리량이 크다면 코드 수정도 감수할만한 선택
