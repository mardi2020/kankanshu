# 처리량과 응답 시간
**응답시간**: 사용자의 요청을 처리하는데 걸리는 시간, API 요청부터 SQL을 실행하고 JSON이 client로 반환될 때까지의 모든 시간
- client가 server로 요청을 보내는 과정
  - TCP를 이용해 서버에 연결, protocol에 맞춰 데이터 전송
- 응답시간의 측정
  - TTFB(Time to First Byte): 응답 데이터 중 첫번째 바이트가 도착할 때까지 걸린시간
  - TTLB(Time to Last Byte): 응답 데이터의 마지막 바이트가 도착할 때까지 걸린시간
  - 파일 크기가 커질 경우, TTFB와 TTLB 간의 차이가 커지기 때문에, 데이터의 특성이나 네트워크 환경을 고려해 두개 중 적절한 지표를 택해 측정해야 함
- 응답시간의 구성
  - 로직 수행(if, for 등), SQL 실행, 외부 API 연동, 응답 데이터 생성 중 **DB 연동과 API 연동이 큰 비중임**

**처리량**: 단위 시간당 시스템이 처리하는 작업량
- TPS: Transaction Per Second
- RPS: Request Per Second
- 서버는 처리할 수 있는 최대 요청수가 있어서 최대 TPS를 초과하는 요청이 들어오면 앞선 요청 먼저 처리하기 때문에 응답 시간이 증가하게 됨
  - 서버가 동시에 처리할 수 있는 요청 수를 늘려 대기 시간 줄이기
  - 처리 시간 자체를 줄여 대기 시간 줄이기
- 현재 서버의 TPS와 응답 시간을 먼저 구하고 성능을 개선안을 도출해야 함
  - 모니터링 시스템(스카우터, 핀포인트, 뉴렐릭 도구 등)을 활용해 실시간 TPS와 특정 시점의 TPS 확인 가능
 
**병목 지점**: 트래픽이 점점 늘면서 데이터가 쌓이고 간헐적으로 응답 시간이 느려지게 됨
- 전형적인 증상들
  - 순간적으로 모든 사용자 요청에 대한 응답 시간이 심각하게 느려짐(Timeout..)
  - 서버를 재시작하면 잠시 괜찮다가 다시 응답시간이 느려짐
  - 트래픽이 줄어들 때까지 지속됨
- 시스템이 수용할 수 있는 최대 TPS를 초과하는 트래픽이 유입되기 때문 -> 최대 TPS를 늘려야 함 -> 먼저 성능 문제 발생 지점을 찾자 -> 원인 분석 -> 개선안 도출
  - 모니터링 도구를 활용해 실제 실행 시간을 측정해 어떤 코드에서 실행 시간이 오래됐는지 찾자
  - 그리고 로그를 남기자
